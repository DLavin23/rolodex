// Forms
// ========================================

// Resets
// ========================================

fieldset
  @extend .border-0
  @extend .margin-0
  min-width: 0
  @extend .padding-0

legend
  @extend .border-0
  @extend .padding-0

button::-moz-focus-inner,
input::-moz-focus-inner
  border: 0   // Vendor prefixes bust the extend
  padding: 0  // Vendor prefixes bust the extend

button[disabled],
html input[disabled]
  @extend %cursor-not-allowed

input[type="checkbox"],
input[type="radio"]
  box-sizing: border-box
  @extend .padding-0

input[type="search"]
  -webkit-appearance: textfield
  box-sizing: border-box

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration
  -webkit-appearance: none

// Default styles
// ========================================

button,
input,
optgroup,
select,
textarea
  color: inherit
  font: inherit
  @extend .margin-0

.form-group
  @extend .margin-bottom
  @extend .position-relative

.form-label
  @extend .display-inline-block
  @extend %font-weight-bold
  +rem(margin-bottom, $baseline-step)

.form-subtle
  @extend %color-gray
  @extend %font-weight-normal
  @extend .s-golf

// Text inputs and textareas

.form-control,
.form-area
  @extend %background-white
  background-image: none
  @extend %border-base
  @extend %border-radius-base
  @extend %color-black
  @extend .display-block
  +rem(padding, ($baseline-step + 2) ($grid-gutter-half - 1))
  @extend .position-relative
  @extend .grid-1-1
  @extend %transition-all

  &:focus
    border-color: $blue
    outline: 0
    z-index: 2

  &[disabled],
  &[readonly],
  [disabled] &
    @extend %background-white-offset
    @extend %color-gray-light
    @extend %cursor-not-allowed

  &:-ms-input-placeholder,
  &:-moz-placeholder,
  &::-webkit-input-placeholder
    color: #999  // Vendor prefixes bust the extend

  &::-moz-placeholder
    opacity: 1

  &[type='search']
    +background-svg("common/icon-search", 15px)
    background-position: 14px 50%
    background-repeat: no-repeat
    +rem(padding-left, 38px)

// Checkboxes and radio buttons

.form-choice
  +rem(padding-left, 20px)

  input
    @extend .pull-left
    +rem(margin, $baseline-step 0 0 -20px)

  label[disabled]
    @extend %cursor-not-allowed
    @extend %color-gray

// Horizontal styles
// ========================================

.form-row
  @extend .display-table
  border-collapse: separate
  @extend .grid-1-1

  .form-label,
  .form-btn
    width: 1%

  .form-label,
  .form-control,
  .form-area,
  .form-btn
    @extend .display-table-cell
    @extend %vertical-align-top

  .form-label,
  .form-btn
    @extend .position-relative

  .form-label
    @extend %background-white-offset
    @extend %border-base
    border-right: 0
    +rem(border-radius, $border-radius-base 0 0 $border-radius-base)
    @extend %color-gray-dark
    +rem(padding, ($baseline-step + 2) ($grid-gutter-half - 1))
    
    &[disabled]
      @extend %color-gray
      @extend %cursor-not-allowed

  > .form-control,
  > .form-area,

    &:first-child
      border-bottom-right-radius: 0
      border-top-right-radius: 0
    
    &:last-child
      border-bottom-left-radius: 0
      border-top-left-radius: 0
    
    &:not(:first-child):not(:last-child)
      border-radius: 0

  .form-btn:last-child
    &:hover,
    &:focus,
    &:active
      z-index: 2
  
    .btn
      border-bottom-left-radius: 0
      border-top-left-radius: 0
      +rem(margin-left, -1px)

// Help blocks
// ========================================

.form-help
  @extend .form-subtle
  +rem(margin-top, $baseline-step)

// Validation
// ========================================

// Errors

.form-error

  &.form-control,
  &.form-area
    border-color: $red
    z-index: 1

  &.form-choice
    @extend %color-red

// Icons

.form-validating,
.form-valid,
.form-invalid
  +rem(background-position, right 14px center)
  background-repeat: no-repeat
  +rem(background-size, 16px)
  +rem(padding-right, 44px)

.form-validating
  background-image: image-url("forms/icon-validating.gif")

.form-valid
  +background-svg("forms/icon-valid")

.form-invalid
  +background-svg("forms/icon-invalid")

// Shake

.form-submit-invalid
  animation: shake 1s ease both
  
@keyframes shake
  0%, 100%
    transform: translateX(0)

  10%, 30%, 50%, 70%, 90%
    transform: translateX(-5px)

  20%, 40%, 60%, 80%
    transform: translateX(5px)
