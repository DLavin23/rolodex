// Forms
// ========================================

// Resets
// ========================================

fieldset
  border: 0
  margin: 0
  min-width: 0
  padding: 0
  @extend %grid-1-1

legend
  border: 0
  padding: 0

button::-moz-focus-inner,
input::-moz-focus-inner
  border: 0   // Vendor prefixes bust the extend
  padding: 0  // Vendor prefixes bust the extend

button[disabled],
html input[disabled]
  @extend %cursor-not-allowed

input[type="checkbox"],
input[type="radio"]
  box-sizing: border-box
  padding: 0

input[type="search"]
  -webkit-appearance: textfield
  box-sizing: border-box

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration
  -webkit-appearance: none

// Default styles
// ========================================

button,
input,
optgroup,
select,
textarea
  color: inherit
  font: inherit
  margin: 0

.form-group
  @extend %margin-bottom
  position: relative

.form-label
  display: inline-block
  @extend %font-weight-bold
  @extend %margin-bottom-step

.form-subtle,
.form-claim
  @extend %s-golf

.form-subtle
  @extend %color-gray
  @extend %font-weight-normal

.form-claim
  float: right
  @extend %line-height-base
  @extend %transition-all

// Text inputs and textareas

.form-control,
.form-area,
.form-placeholder
  @extend %background-white
  background-image: none
  @extend %border-base
  @extend %border-radius-base
  @extend %color-black
  display: block
  +rem(padding, ($baseline-step + 2) ($gutter-half - 1))
  position: relative
  @extend %grid-1-1
  transition: border .15s ease, background-image .15s ease

  &:focus
    border-color: $blue
    outline: 0
    z-index: 2

  &[disabled],
  &[readonly],
  [disabled] &
    @extend %background-white-offset
    @extend %color-gray-light
    @extend %cursor-not-allowed

  &:-ms-input-placeholder,
  &:-moz-placeholder,
  &::-webkit-input-placeholder
    color: #999 // Vendor prefixes bust the extend

  &::-moz-placeholder
    opacity: 1 // Vendor prefixes bust the extend

  &[type='search']
    +background-svg("forms/icon-search", 15px)
    background-position: 14px 50%
    background-repeat: no-repeat
    +rem(padding-left, 38px)

.form-area
  +rem(min-height, $baseline-large)

.form-date
  +background-svg("forms/icon-calendar", 20px 21px)
  background-position: right 14px top 50%
  background-repeat: no-repeat
  +rem(padding-right, 48px)

.form-placeholder
  @extend %background-white-offset

.form-placeholder-link
  float: right
  @extend %line-height-base
  @extend %s-golf

// Checkboxes and radio buttons

.form-choice
  +rem(padding-left, 20px)

  input[type="radio"],
  input[type="checkbox"]
    float: left
    @extend %margin-top-step
    +rem(margin-left, -20px)

  label[disabled]
    @extend %cursor-not-allowed
    @extend %color-gray

// Custom radio buttons

.form-radio
  &:not(:last-of-type)
    +rem(margin-bottom, $baseline-step / 2)

  label
    @extend %cursor-pointer
    +rem(padding-left, 6px)
    position: relative

    &:before
      +background-svg("forms/radio-button", 20px 40px)
      @extend %content-empty
      +rem(height, 20px)
      +rem(left, -20px)
      position: absolute
      top: 0
      +rem(width, 20px)

.form-radio-active:before
  +rem(background-position, 0 -20px)

// Horizontal styles
// ========================================

.form-row
  display: table
  border-collapse: separate
  @extend %grid-1-1

  .form-label,
  .form-btn
    width: 1%

  .form-label,
  .form-control,
  .form-area,
  .form-btn
    display: table-cell
    vertical-align: top

  .form-label,
  .form-btn
    position: relative

  .form-label
    @extend %background-white-offset
    @extend %border-base
    border-right: 0
    +rem(border-radius, $border-radius-base 0 0 $border-radius-base)
    @extend %color-gray-dark
    +rem(padding, ($baseline-step + 2) ($gutter-half - 1))
    @extend %white-space-nowrap

    &[disabled]
      @extend %color-gray
      @extend %cursor-not-allowed

  > .form-control,
  > .form-area,

    &:first-child
      border-bottom-right-radius: 0
      border-top-right-radius: 0

    &:last-child
      border-bottom-left-radius: 0
      border-top-left-radius: 0

    &:not(:first-child):not(:last-child)
      border-radius: 0

  .form-btn:last-child
    &:hover,
    &:focus,
    &:active
      z-index: 2

    .btn
      border-bottom-left-radius: 0
      border-top-left-radius: 0
      +rem(margin-left, -1px)

// Help blocks
// ========================================

.form-help
  @extend %color-gray
  @extend %s-golf
  @extend %font-weight-normal
  @extend %margin-top-step
  @extend %margin-gutters-half

  .form-choice &
    margin-left: 0

.form-help-title
  @extend %color-gray-dark
  display: inline-block
  @extend %margin-top-step
  @extend %margin-bottom-step

.form-help-suggestions

  li
    @extend %line-height-base
    +rem(padding-left, 18px)
    position: relative

  .i-suggest-tick,
  .form-help-bullet
    position: absolute
    left: 0
    @extend %transition-all

  .i-suggest-tick
    @extend %opacity-0
    +rem(top, 7px)

.form-help-bullet
  display: inline-block
  @extend %s-delta
  @extend %text-center
  +rem(width, 12px)

.form-help-success

  .i-suggest-tick
    @extend %opacity-1

  .form-help-bullet
    @extend %opacity-0

// Validation
// ========================================

// Errors

.form-error

  &.form-control,
  &.form-area
    border-color: $red
    z-index: 1

  &.form-choice
    @extend %color-red

// Icons

.form-validating,
.form-valid,
.form-invalid
  +rem(background-position, right ($gutter-half - 1) top $baseline-x-small)
  background-repeat: no-repeat
  +rem(background-size, 16px)
  +rem(padding-right, 44px)

.form-validating
  background-image: image-url("forms/icon-validating.gif")

.form-valid
  +background-svg("icons/icon-valid")

.form-invalid,
.form-invalid:focus
  +background-svg("icons/icon-invalid")
  border-color: $red

// Shake

.form-submit-invalid
  animation: shake 1s ease both

@keyframes shake
  0%, 100%
    transform: translateX(0)

  10%, 30%, 50%, 70%, 90%
    +rem(transform, translateX(-5px))

  20%, 40%, 60%, 80%
    +rem(transform, translateX(5px))
